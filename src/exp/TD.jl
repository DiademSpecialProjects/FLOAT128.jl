const td_inv_fact = TD[
      TD(1.0, 0.0, 0.0),
      TD(0.5, 0.0, 0.0),
      TD(0.16666666666666666, 9.25185853854297e-18, 5.135813185032629e-34),
      TD(0.041666666666666664, 2.3129646346357427e-18, 1.2839532962581572e-34),
      TD(0.008333333333333333, 1.1564823173178714e-19, 1.6049416203226965e-36),
      TD(0.001388888888888889, -5.300543954373577e-20, -1.7386867553495878e-36),
      TD(0.0001984126984126984, 1.7209558293420705e-22, 1.4926912391394127e-40),
      TD(2.48015873015873e-5, 2.1511947866775882e-23, 1.865864048924266e-41),
      TD(2.7557319223985893e-6, -1.858393274046472e-22, 8.491754604881993e-39),
      TD(2.755731922398589e-7, 2.3767714622250297e-23, -3.263188903340883e-40),
      TD(2.505210838544172e-8, -1.448814070935912e-24, 2.0426735146714455e-41),
      TD(2.08767569878681e-9, -1.20734505911326e-25, 1.702227928892871e-42),
      TD(1.6059043836821613e-10, 1.2585294588752098e-26, -5.31334602762985e-43),
      TD(1.1470745597729725e-11, 2.0655512752830745e-28, 6.889079232466646e-45),
      TD(7.647163731819816e-13, 7.03872877733453e-30, -7.827539277162583e-48),
      TD(4.779477332387385e-14, 4.399205485834081e-31, -4.892212048226615e-49),
      TD(2.8114572543455206e-15, 1.6508842730861433e-31, -2.877771793074479e-50),
      TD(1.5619206968586225e-16, 1.1910679660273754e-32, -4.577506059629983e-49),
      TD(8.22063524662433e-18, 2.2141894119604265e-34, -1.508914023774199e-50),
      TD(4.110317623312165e-19, 1.4412973378659527e-36, -5.285627548789812e-53),
      TD(1.9572941063391263e-20, -1.3643503830087908e-36, 1.3392348251125064e-53),
      TD(8.896791392450574e-22, -7.911402614872376e-38, -3.1877976790570933e-54),
      TD(3.868170170630684e-23, -8.843177655482344e-40, 3.8718157106173247e-56),
      TD(1.6117375710961184e-24, -3.6846573564509766e-41, 1.613256546090552e-57),
      TD(6.446950284384474e-26, -1.9330404233703465e-42, -1.5213023807039144e-58),
      TD(2.4795962632247976e-27, -1.2953730964765229e-43, 6.403390159849962e-60),
      TD(9.183689863795546e-29, 1.4303150396787322e-45, -8.551226774650505e-62),
      TD(3.279889237069838e-30, 1.5117542744029879e-46, 8.058517719519716e-63),
      TD(1.1309962886447716e-31, 1.0498015412959506e-47, -4.346150929397795e-64),
      TD(3.7699876288159054e-33, 2.5870347832750324e-49, 3.23789002742564e-66),
      TD(1.216125041553518e-34, 5.586290567888806e-51, 6.615948578082792e-68),
      TD(3.8003907548547434e-36, 1.7457158024652518e-52, 2.0674839306508725e-69),
      TD(1.151633562077195e-37, -6.09957445788454e-54, -5.3447496196594105e-70),
      TD(3.387157535521162e-39, 5.09056148151085e-56, 3.989567349036344e-72),
      TD(9.67759295863189e-41, 3.202295548645562e-57, 6.547507205018101e-74),
      TD(2.6882202662866363e-42, 5.355061165943334e-59, -1.1290601987449868e-75),
      TD(7.265460179153071e-44, -4.364097149354446e-61, 2.5503250121018375e-77),
      TD(1.911963205040282e-45, -2.7860822176883126e-62, 2.0347437224101328e-78),
      TD(4.902469756513544e-47, -1.213019100517928e-63, -4.4707180011376586e-80),
      TD(1.2256174391283858e-48, 6.033927348315605e-68, 4.0762496124582373e-84),
      TD(2.9893108271424046e-50, -1.0407247703033156e-66, -1.3761319713775906e-83),
      TD(7.117406731291439e-52, 3.1742075384205573e-68, 1.2411289864622588e-84),
      TD(1.6552108677421951e-53, 4.147105190494824e-70, 4.321874177581813e-88),
      TD(3.7618428812322616e-55, 2.2597135911236184e-71, -1.452551873877095e-87),
      TD(8.359650847182804e-57, -5.0402798850883064e-73, -1.971165125943993e-89),
      TD(1.817315401561479e-58, 1.365069339879366e-74, 2.5449015040142434e-91),
      TD(3.866628513960594e-60, -1.564355005786389e-76, -1.2863855447354847e-92),
      TD(8.055476070751236e-62, 8.255818478070949e-78, -2.679969884865593e-94),
      TD(1.643974708316579e-63, -4.080880981844294e-80, -3.32913139064192e-96),
      TD(3.287949416633158e-65, 5.332251403646481e-82, 8.324193862236773e-99),
      TD(6.446959640457172e-67, 2.8542499223476843e-83, -1.3428344869006296e-99),
      TD(1.2397999308571486e-68, -2.430377210051421e-85, -8.239318728361721e-102),
      TD(2.3392451525606576e-70, 8.161871936085597e-87, 4.847758386854871e-103),
      TD(4.331935467704922e-72, -1.0950890458548228e-88, -6.008669702432555e-105),
      TD(7.876246304918039e-74, 2.578848742504751e-90, -5.375571071117659e-107),
      TD(1.4064725544496498e-75, 1.1618077704898094e-91, -2.9064193324175937e-108),
      TD(2.4674957095607893e-77, -4.7567198485936506e-95, -4.498838274048994e-112),
      TD(4.254302947518602e-79, 3.3126660495569664e-96, -9.378759508473191e-113),
      TD(7.2106829618959365e-81, -4.675660659561278e-97, -2.2732826558679996e-113),
      TD(1.2017804936493226e-82, 6.837470842477656e-99, 1.0840439011993803e-115),
      TD(1.9701319568021682e-84, 8.210968879386911e-101, 1.3610651106029761e-117),
      TD(3.1776321883905942e-86, -1.5561627595804251e-102, 2.834868584973462e-119),
      TD(5.043860616493007e-88, -3.178797157619149e-104, 2.613713035752867e-120),
      TD(7.881032213270323e-90, -4.96687055877992e-106, 4.0839266183638546e-122)
  ];

# |a| <= 0.2
function exp_taylor(a::TD)
  x = a
  x2 = x*x
  x3 = x*x2
  x4 = x2*x2
  x5 = x2*x3
  x10 = x5*x5
  x15 = x5*x10
  x20 = x10*x10
  x25 = x10*x15

  z = x + td_inv_fact[2]*x2 + td_inv_fact[3]*x3 + td_inv_fact[4]*x4
  z2 = x5 * (td_inv_fact[5] + x*td_inv_fact[6] + x2*td_inv_fact[7] + x3*td_inv_fact[8] + x4*td_inv_fact[9])
  z3 = x10 * (td_inv_fact[10] + x*td_inv_fact[11] + x2*td_inv_fact[12] + x3*td_inv_fact[13] + x4*td_inv_fact[14])
  z4 = x15 * (td_inv_fact[15] + x*td_inv_fact[16] + x2*td_inv_fact[17] + x3*td_inv_fact[18] + x4*td_inv_fact[19])
  z5 = x20 * (td_inv_fact[20] + x*td_inv_fact[21] + x2*td_inv_fact[22] + x3*td_inv_fact[23] + x4*td_inv_fact[24])
  z6 = x25 * (td_inv_fact[25] + x*td_inv_fact[26] + x2*td_inv_fact[27] + x3*td_inv_fact[28])

  ((((z6+z5)+z4)+z3)+z2)+z + one(DD)
end

